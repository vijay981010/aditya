<!-- include header -->
<%- include('include/_header') %>
<!-- /include header -->

<!-- include header -->
<%- include('include/_navbar') %>
<!-- /include header -->
<div class="container-fluid" style="margin-bottom:50px"> 
    <div class="container-fluid">
        <header class="row py-3 mb-4 border-bottom">
            <div class="col-md-3">                
                <span class="fs-4 text-dark">List of orders</span>
            </div>
            <div class="col-md-6"></div>
            <div class="col-md-3 d-flex flex-row-reverse">
                <a href="/orders/add" class="btn btn-primary">Add Order</a>
            </div>
        </header>
    </div> 
      
    <table id="myTable" class="display cell-border responsive" style="width:100%; overflow-y:visible; overflow-x: visible;">
        <thead>
            <tr>
                <th>BOOKING DATE</th>
                <th>AWB</th>
                <% if(user.role == 'admin'){ %>
                <th>CONSIGNOR REFERENCE</th>
                <% } %>
                <th>CONSIGNOR</th>
                <th>CONSIGNEE</th>   
                <th>ACTION</th>    
                <th>ORIGIN</th>
                <th>DESTINATION</th>
                <th>NUMBER OF BOX</th>
                <th>CHARGEABLE WEIGHT</th>
                <% if(user.role == 'admin'){ %>
                <th>TRACKING NUMBER</th>
                <th>VENDOR</th>    
                <% } %>                  
            </tr>
        </thead>
        <tbody>          
            <% orderlist.slice().reverse().forEach(order => { %> 
                <tr>
                    <td><%= moment(order.bookingDate).format(shortDateFormat) %></td>
                    <% if(order.vendorName == 'OTHERS' && user.role == 'admin'){ %>
                    <td><a href="/orders/<%= order._id %>/trackingdetails"><%= order.awbNumber %></a></td>
                    <% }else{ %>
                    <td><%= order.awbNumber %></td>
                    <% } %>                    
                    <% if(user.role == 'admin'){ %>
                    <td><%= order.client.username %></td>
                    <% } %>
                    <td><%= order.consignor %></td>
                    <td><%= order.consignee %></td>
                    <td>                        
                        <div class="dropdown">
                            <button class="btn btn-primary dropdown-toggle" type="button" id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                Action
                            </button>
                            <div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
                                <a class="dropdown-item" href="<%= order._id %>">Primary Details</a>
                                <a class="dropdown-item" href="<%= order._id %>/box">Box Details</a>
                                <% if(user.role == 'admin'){ %>
                                <a class="dropdown-item" href="<%= order._id %>/track">Tracking Details</a>
                                <% } %>                
                                <a class="dropdown-item" href="<%= order._id %>/print/awb" target="_blank">Print AWB</a>
                                <a class="dropdown-item" href="<%= order._id %>/print/boxsticker" target="_blank">Box Sticker</a>
                                <a class="dropdown-item" href="<%= order._id %>/print/packinglist" target="_blank">Packing List</a>                
                            </div>
                        </div>                        
                    </td>
                    <td><%= order.origin %></td>
                    <td><%= order.destination %></td>
                    <td><%= order.numberOfBoxes %></td>
                    <td><%= order.chargeableWeight %></td>
                    <% if(user.role == 'admin'){ %>
                    <td><%= order.trackingNumber %></td>
                    <td><%= order.vendorName %></td>
                    <% } %>
                </tr>
            <% }) %>                                                                                                           
        </tbody>
    </table>       
</div>


<!-- include footer -->
<%- include('include/_footer') %>
<!-- /include footer -->