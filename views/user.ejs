<!-- include header -->
<%- include('include/_header') %>
<!-- /include header -->

<!-- include header -->
<%- include('include/_navbar') %>
<!-- /include header -->
<div class="container-fluid" style="margin-bottom:50px"> 
    <div class="container-fluid">
        <header class="row py-3 mb-4 border-bottom">
            <div class="col-md-3">                
                <span class="fs-4 text-dark">List of users</span>
            </div>
            <div class="col-md-6"></div>
            <div class="col-md-3 d-flex flex-row-reverse">
                <a href="/users/add" class="btn btn-primary">Add User</a>
            </div>
        </header>
    </div> 

    <div class="row justify-content-center">        
        <div class="col-md-6">
            <div class="alert alert-success" role="alert" id="success"> 
                <strong>Success!</strong> User status updated successfully.                               
            </div>            
            <div class="alert alert-warning" id="warning">
                <strong>Error!</strong> Failed to update user status.
            </div>
            <div class="alert alert-danger" id="danger">
                <strong>Unknown!</strong> Some unknown error.
            </div>
        </div>
    </div>
    
      
    <table id="myTable" class="display cell-border responsive" style="width:100%">
        <thead>
            <tr>
                <th>DATE CREATED</th>
                <th>USERNAME</th>
                <th>STATUS</th>

                <% if(user.role == 'superadmin'){ %>
                <th>ACCESS</th>
                <th>API CREDIT</th>
                <% } %>        

                <% if(user.role == 'admin'){ %>
                <th>SERVICES</th>
                <% } %>                

                <th>ACTION</th>                
            </tr>
        </thead>
        <tbody>                      
            <% userList.slice().reverse().forEach((client,i) => { %> 
                <tr>
                    <td><%= moment(client.createdAt).format(shortDateFormat) %></td>                    
                    <td><%= client.username %></td>

                    <td>
                        <label class="switch">
                            <input class="myClass" type="checkbox" id="<%= client._id %>" name="status" <%= client.status == 'active' ? 'checked' : '' %> >
                            <span class='slider round'></span>
                        </label>                        
                    </td>

                    <% if(user.role == 'superadmin'){ %>
                    <td><%= client.accessRight %></td>
                    <td><%= client.apiCredit %></td>
                    <% } %>
                
                    <% if(user.role == 'admin'){ %>
                    <td></td>
                    <% } %>

                    <td>                                                
                        <a class="btn btn-primary" href="/users/<%= client._id %>/edit">Edit</a>
                    </td>
                </tr>
            <% }) %>                                                                                                           
        </tbody>
    </table>    
</div>

       


<!-- include footer -->
<%- include('include/_footer') %>
<!-- /include footer -->